FROM openjdk:11 AS BUILD_IMAGE
WORKDIR /usr/app/

# build
ARG JAR_FILENAME='user-service-1.0-SNAPSHOT.jar'
ARG PACKAGE_JAR_LOCATION=build/libs/${JAR_FILENAME}
ARG VERSION

# run
ENV COMMAND_LINE_ARGS_BEFORE=${COMMAND_LINE_ARGS_BEFORE}
ENV COMMAND_LINE_ARGS_AFTER=${COMMAND_LINE_ARGS_AFTER}
ENV SERVER_PORT=8888
ENV VERSION=${VERSION}

ADD ${PACKAGE_JAR_LOCATION} app.jar

EXPOSE ${SERVER_PORT}:8888
ENTRYPOINT java ${COMMAND_LINE_ARGS_BEFORE} ${VERSION} -jar ./app.jar ${COMMAND_LINE_ARGS_AFTER}
